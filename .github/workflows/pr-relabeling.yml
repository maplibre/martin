name: Relabel Pull Request

on:
  # SECURITY: pull_request_target is used here to allow validation of PRs from forks.
  # This is safe because:
  # 1. No user-controllable code from the PR is checked out or run
  # 2. Permissions are restricted to pull-requests: write
  pull_request_target: # zizmor: ignore[dangerous-triggers]
    types: [labeled]

permissions: {}

jobs:
  remove-bless:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    if: contains(github.event.label.name, 'bless')

    steps:
      - name: Remove bless label
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          gh pr edit ${{ github.event.pull_request.number }} --repo ${{ github.repository }} --remove-label bless
